###########################################################
# author : Thomas CLAUZEL
# name : generator.py
# version : 1.0
# Python version : 99999
# description : generateur de wordlist basé sur des mots
###########################################################
# modules
import os
import math

# fonctions utiles
def convert_size(size_bytes):
    if size_bytes == 0:
        return "0B"
    size_name = ("B", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB")
    i = int(math.floor(math.log(size_bytes, 1024)))
    p = math.pow(1024, i)
    s = round(size_bytes / p, 2)
    return "%s %s" % (s, size_name[i])
def leet(text):
    getchar = lambda c: chars[c] if c in chars else c
    chars = {"a":"4","e":"3","l":"1","o":"0","s":"5"}
    return ''.join(getchar(c) for c in text)

with open("data.txt", "r") as f:
    for line in f.readlines():
        mot = line.strip()
        f = open("dico.txt", "a")
        print(mot)
        f.write(mot + '\n')
        print(mot.title())
        f.write(mot.title() + '\n')
        i = 0
        while i <= 99999:
            print(mot + str(i))
            f.write(mot + str(i) + '\n')
            print(mot.title() + str(i))
            f.write(mot.title() + str(i) + '\n')
            print(leet(mot + str(i)))
            f.write(leet(mot + str(i)) + '\n')
            print(leet(mot.title() + str(i)))
            f.write(leet(mot.title() + str(i)) + '\n')
            i = i + 1
        print(leet(mot))
        f.write(leet(mot) + '\n')
        # https://www.owasp.org/index.php/Password_special_characters
        SpecialChars = ["@", "!", "#", "&", ")","(","+","-", "=", "?","/", "[", "]","{","}","_"]
        for value in SpecialChars:
            print(mot + value)
            f.write(mot + value + '\n')
            print(mot.title() + value)
            f.write(mot.title() + value + '\n')
        i = 0
        while i <= 99999:
            for value in SpecialChars:
                print(mot + str(i) + value)
                f.write(mot + str(i) + value + '\n')
                print(mot.title() + str(i) + value)
                f.write(mot.title() + str(i) + value + '\n')
                print(leet(mot) + str(i) + value)
                f.write(leet(mot) + str(i) + value + '\n')
                print(leet(mot.title()) + str(i) + value)
                f.write(leet(mot.title()) + str(i) + value + '\n')
            i = i + 1
        f.close()
        print("-------------------------------" + '\n')
        file = 'dico.txt'
        size_bytes = os.path.getsize(file)
        print("size of the wordlist : " + convert_size(size_bytes) + '\n')
        print("-------------------------------" + '\n')
